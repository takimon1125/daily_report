## 取り組んだ課題一覧
- Progate
    - Ruby on Rails5（道場レッスン以外）

## わかったこと
- Ruby on Rails5
    - Railsで開発を始めるには、「rails new アプリケーション名」
    - サーバーの起動は、「rails server」
    - ページを作成するには、「rails generate controller home top」
「rails generate controller home top」を実行すると、
viewsフォルダの中に「homeフォルダ」と「top.html.erb」という
ファイルが作成されます。
    - ページを表示するとき、Railsの中ではコントローラを経由してビューをブラウザに返す。
コントローラ内のメソッドを「アクション」
    - ルーティングは、送信されたURLに対して「どのコントローラの、
どのアクション」で処理するかを決める
    - ルーティングは「config/routes.rb」に定義され、右の図のように
「get "URL" => "コントローラー名#アクション名"」という文法で
書かれる。
    - CSSファイルは「app/assets/stylesheets」
    - 画像は、「public」フォルダに配置しておくと、「<img src=/画像名" >」や「background-image: url("/画像名");」のように、画像名を指定するだけで、簡単に画像を表示することができる。
    - 「localhost:3000」 (後ろに/○○がないURL) に対応するルーティングは、
「get "/" => "コントローラ名#アクション名"」というように、URLに"/"を
指定します。
    - <% %>で囲むことで、HTMLファイルの中にRubyのコードを記述することができます。「erb」とは「Embedded Ruby（埋め込みRuby）」の略です。
埋め込むRubyコードをブラウザに表示したい場合には、以下の図のように
<% %>ではなく、<%= %>
    - 通常、アクションで定義した変数をビューで使用することはできません。
しかし、変数名を「@」から始めることでこの変数は特殊な変数となり、ビューファイルでも使用することができる。
    - データベースに変更を指示するためのファイルを作成しましょう。右の図のようなpostsテーブルを作成するマイグレーションファイルは「rails g model Post content:text」というコマンドで作成することができる。
    - DB作成はrails db:migrate
    - 「views/layouts/application.html.erb」に共通のHTMLを書いておくことができる。
「views/layouts/application.html.erb」には<%= yield %>というコードがありる。top.html.erbなどの各ビューファイルは、この<%= yield %>の部分に代入され、application.html.erbの一部としてブラウザに表示されていた。この仕組みによって、ヘッダーなどの共通のレイアウトを1つにまとめることができる。
    - 特定のidの投稿を取得するためには、find_byメソッドを用いる。
find_byメソッドは、ある条件に合致するデータを取得することができる。
図のように、「モデル名.find_by(カラム名: 値)」とすることで、その値を持ったデータをデータベースから取得することができる。
    - ルーティングのURL部分に「:」を用いて「posts/:id」と指定することで、「/posts/1」でも「/posts/2」でもshowアクションにいくようにすることができる。
「posts/:id」と書くと「/posts/◯◯」のような全てのURLが該当する。
    - コントローラのアクション内では、ルーティングで設定したURLの「:id」の値を取得することができます。その値はparamsという変数にハッシュとして入っている。
params[:id]とすることで、その値を取得することができる。
    - 投稿一覧ページに、各投稿の詳細ページへのリンクを作成する。
各投稿の内容の部分をクリックすると詳細ページに移動できるように、link_to(post.content, "/posts/#{post.id}")とする。
    - form_tagメソッドを用いると、フォームに入力されたデータを送信することができます。form_tagは、「form_tag(送信先のURL) do」のように送信先のURLを指定する。
これによって、<input type=submit" ...>のボタンを押した時に、指定されたURLにデータが送信される。
    - 他のURLに転送（リダイレクト）するには、redirect_toメソッドを用います。
redirect_toは「redirect_to(URL)」とすることで、そのページに転送することができます。
   - 入力データを受け取るためのparamsはURLからidの値を取得するときにも使いました。
paramsは以下の2通りの使い方がある。
      - 「:○○」を使ったルーティングのURLから値を取得する
      -　「name="○○"」が付いたフォームの入力内容を受け取る
   - orderメソッドを用いることで、投稿一覧を並び替えることができる。
order(カラム名: 並び替えの順序）のように使います。並び替えの順序には、昇順（:asc）と降順（:desc）のどちらかを指定できる。
created_atを基準に降順（:desc）に並べ替えると、新しいものから順番に表示するようにできる。
    - 投稿に対してdestroyメソッドを用いることで、データベースから削除することができる。
destroyアクションのルーティングは以下のように、getではなくpostにします。destroyアクションでも、URLのidから削除したい投稿を特定できるように、「posts/:id/destroy」とURLの中にidを含むことに注意する。
    - link_toの第三引数に「{method: "post"}」を追加することで、「post」として定義されているルーティングにマッチするようになる。
    - バリデーションは図のように、モデルで設定する。
「validates」を用いてカラム名と内容を指定する。
{presence: true}を用いることで、「そのカラムの値が存在するかどうか」をチェックすることができます。
    - マイグレーションファイルのみを作成するには、「rails g migration ファイル名」とします。指定したファイル名のマイグレーションファイルが作成される。ファイル名は自由に指定できますが、追加するカラム名を含めるなど分かりやすい名前が望ましい。
また、ファイル名には先頭にファイルの作成日時が自動的に追加される。
    - バリデーションでは、値が存在しているかだけでなく、文字数もチェックすることができる。
「length」を用い、{maximum: 数値}を指定することで、最大文字数を設定することができます。
    - saveメソッドを呼び出した際にバリデーションに失敗すると、Railsでは自動的にエラーメッセージが生成されるようになっている。@post.errors.full_messagesの中に、エラー内容が配列で入る。
    - ページ上に1度だけ表示されるメッセージをフラッシュといいます。
Railsではフラッシュを表示するために、特殊な変数flashが用意されています。アクションで変数flash[:notice]に文字列を代入すると、flash[:notice]をビューで使うことができます。変数flashは１度表示された後に自動で削除されるようになっている。flashはいろいろな箇所で共通で使っていくのでapplication.html.erbで表示しましょう
    - データベースにすでに保存されているemailで新たにユーザーを登録できないように、「emailの重複がないか」をチェックするためのバリデーションを追加する。
「uniqueness: true」を指定することでチェックすることができる。
   - テーブルに変更を加えるためには、マイグレーションファイルの中の
changeメソッドの中に変更内容を書く必要がある。
「rails db:migrate」コマンドはこのchangeメソッドの中身を実行するためのコマンド
   - カラムを追加する場合には左の図のように、
「add_column :テーブル名, :カラム名, :データ型」とします。
changeメソッドの中身を追加したら、「rails db:migrate」でデータベースに変更を反映する。
   - ユーザー画像を表示するためには、今まで画像を表示してきた時と同様に、HTMLの<img>タグを用います。
画像はpublic/user_imagesフォルダに保存されているので、src属性の値を「/user_images/ファイル名」とする必要があります。
Rubyのコード部分は<%= %>で囲む必要がある。
   - 画像の送信は特殊なので、form_tagに{multipart: true}を追加する必要があります。
詳しく理解する必要はないので、「画像を送信したいときには{multipart: true}をつける必要がある」ということだけ覚えておく。
   - Rubyのコードでファイルを扱うには、Rubyに元から用意されてあるFileクラスを用います。
ファイルを作成するためには、Fileクラスのwriteメソッドを使う。
「File.write(ファイルの場所, ファイルの中身)」とすることで、ファイルを作成することができる。
   - 画像を保存するには、画像データを元に画像ファイルを作成する必要がある。ファイルを作成するためにはFileクラスを用います。ただし、画像データは特殊なテキストファイルであるため、File.writeではなくFile.binwriteを用いる必要があります。imageに対し、readメソッドを用いることでその画像データを取得できる。
   - 各コントローラの全アクションで共通する処理がある場合には、before_actionを使うと便利です。before_actionを用いることで、アクションが呼び出される際に必ずbefore_actionの処理が実行されます。
   - onlyを用いて各コントローラでbefore_actionを使うことで、指定したアクションでのみそのメソッドを実行することができます。各コントローラは、applicationコントローラを継承しているので、継承元のメソッドを使うことができる。
   - HTML要素に対してlink_toメソッドを使うには、少し異なる書き方をする必要があります。
右の図のように、<%= link_to(URL) do %>と<% end %>の間にHTML要素を書くことで、その部分をリンクにすることができる。
    - gemとは、RubyやRailsでプログラミングをする際に「よく使う機能」をパッケージ化したもの。「検索機能を作るgem」や「ハッシュ化するgem」など様々なgemが存在し、Railsにインストールすることで使用することができる。今回はbcryptという「ハッシュ化するgem」を使います。
    - カラムを削除する場合は、add_columnの代わりにremove_columnを用います。
    - has_secure_passwordメソッドを有効にすると、authenticateメソッドを使えるようになる。authenticateメソッドは渡された引数をハッシュ化し、password_digestの値と一致するかどうかを判定してくれる。authenticateメソッドを使って、「送信されたメールアドレスと一致するユーザー」のpassword_digestと、送信されたパスワードが一致するかどうかでログイン処理をします。


## 次やること
- Progate
    - Ruby on Rails5 道場レッスン
    - JavaScript
    - Node.js


## 感じたこと
- 日報を忘れていたので、反省中。                                                                                                                                                           
- 集中力が途切れていた時があったので、休む時は休む、やる時はやるを意識したい。                                                                                                                                        

## 学習時間
- 本日：7h
- 合計：20h
